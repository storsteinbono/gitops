apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component

# AI stack - Ollama and Open WebUI
# Requires GPU components to be enabled

resources:
  - ../../../apps/ollama/application.yaml
  - ../../../apps/open-webui/application.yaml

labels:
  - pairs:
      app-category: ai
      app-stack: llm
      requires: gpu

patches:
  # Enable Ollama (set replicas to 1)
  - patch: |-
      apiVersion: argoproj.io/v1alpha1
      kind: Application
      metadata:
        name: ollama
      spec:
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
    target:
      kind: Application
      name: ollama
